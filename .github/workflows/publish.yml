name: Deprem Verilerini GÃ¼ncelle

on:
  schedule:
    - cron: "*/3 * * * *"  # Her 3 dakikada bir
  workflow_dispatch:

jobs:
  update-data:
    runs-on: ubuntu-latest
    steps:
      - name: Repo'yu klonla
        uses: actions/checkout@v4

      - name: Node.js kurulum
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: BaÄŸÄ±mlÄ±lÄ±klarÄ± yÃ¼kle
        run: npm install

      - name: AFAD verisini gÃ¼ncelle
        run: node scripts/afad.js || echo "AFAD verisi alÄ±namadÄ±"

      - name: BoÄŸaziÃ§i verisini gÃ¼ncelle
        run: node scripts/bogazici.js || echo "BoÄŸaziÃ§i verisi alÄ±namadÄ±"

      - name: USGS verisini gÃ¼ncelle
        run: node scripts/usgs.js || echo "USGS verisi alÄ±namadÄ±"

      - name: /api klasÃ¶rÃ¼nÃ¼ oluÅŸtur
        run: mkdir -p api

      - name: JSON dosyalarÄ±nÄ± taÅŸÄ±
        run: |
          mv afad-depremler.json api/afad-depremler.json || echo "AFAD JSON yok"
          mv boun-depremler.json api/boun-depremler.json || echo "BOUN JSON yok"
          mv usgs-depremler.json api/usgs-depremler.json || echo "USGS JSON yok"

      - name: README gÃ¼ncelleme (isteÄŸe baÄŸlÄ±)
        run: node scripts/update-readme.js || echo "README gÃ¼ncellemesi atlandÄ±"

      - name: Git ayarlarÄ±nÄ± yap
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"

      - name: DeÄŸiÅŸiklikleri commit et
        run: |
          git add api/*.json README.md || echo "Dosya yok"
          git commit -m "ğŸ”„ Veri gÃ¼ncellendi: $(date '+%Y-%m-%d %H:%M:%S')" || echo "Commit edilecek deÄŸiÅŸiklik yok"

      - name: DeÄŸiÅŸiklikleri main branch'e gÃ¶nder
        run: git push origin main
